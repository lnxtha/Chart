{% extends 'base.html' %}
{% load static %}



{% block title %}<title>Dashboard</title>{% endblock %}
{% block body %}



    <!-- sidebar menu area end -->
    <!-- main content area start -->
    <div class="main-content">
        <!-- header area start -->
        <div class="header-area">
            <div class="row align-items-center">
                <!-- nav and search button -->
                <div class="col-md-6 col-sm-8 clearfix">
                    <div class="nav-btn pull-left">
                        <span></span>
                        <span></span>
                        <span></span>
                    </div>
                    <div class="search-box pull-left">
                        <form action="#">
                            <input type="text" name="search" placeholder="Search..." required>
                            <i class="ti-search"></i>
                        </form>
                    </div>
                </div>
                <!-- profile info & task notification -->
                <div class="col-md-6 col-sm-4 clearfix">
                    <ul class="notification-area pull-right">
                        <li id="full-view"><i class="ti-fullscreen"></i></li>
                        <li id="full-view-exit"><i class="ti-zoom-out"></i></li>
                        <li class="dropdown">
                            <i class="ti-bell dropdown-toggle" data-toggle="dropdown">
                                <span>0</span>
                            </i>
                            <div class="dropdown-menu bell-notify-box notify-box">
                                <span class="notify-title">You have no notifications <a href="#">view all</a></span>
                                <div class="nofity-list">

                                </div>
                            </div>
                        </li>
                        <li class="dropdown">
                            <i class="fa fa-envelope-o dropdown-toggle" data-toggle="dropdown"><span>0</span></i>
                            <div class="dropdown-menu notify-box nt-enveloper-box">
                                <span class="notify-title">You have no new notifications <a href="#">view all</a></span>
                                <div class="nofity-list">

                                </div>
                            </div>
                        </li>
                        <li class="settings-btn">
                            <i class="ti-settings"></i>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
        <!-- header area end -->
        <!-- page title area start -->
        <div class="page-title-area">
            <div class="row align-items-center">
                <div class="col-sm-6">
                    <div class="breadcrumbs-area clearfix">
                        <h4 class="page-title pull-left">Dashboard</h4>
                        <ul class="breadcrumbs pull-left">
                            <li><a href="index.html">Home</a></li>
                            <li><span>Dashboard</span></li>
                        </ul>
                    </div>
                </div>
                <div class="col-sm-6 clearfix">
                    <div class="user-profile pull-right">
                        <img class="avatar user-thumb" src="{% static 'assets/images/author/avatar.png' %}"
                             alt="avatar">
                        <h4 class="user-name dropdown-toggle" data-toggle="dropdown">Dorukhan <i
                                class="fa fa-angle-down"></i></h4>
                        <div class="dropdown-menu">
                            <a class="dropdown-item" href="#">Message</a>
                            <a class="dropdown-item" href="#">Settings</a>
                            <a class="dropdown-item" href="#">Log Out</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- page title area end -->
        <div class="main-content-inner">


            <div class="row">
                {% for row in averagepricebyroomtype %}
                    <div class="col-md-4">
                        <div class="single-report mb-xs-30">
                            <div class="s-report-inner pr--20 pt--30 mb-3">
                                <div class="icon"><i class="fa fa-btc"></i></div>
                                <div class="s-report-title d-flex justify-content-between">
                                    <h4 class="header-title mb-0">{{ row.room_type }}</h4>
                                    <p>24 H</p>
                                </div>
                                <div class="d-flex justify-content-between pb-2">
                                    <h2>$ {{ row.price }}</h2>
                                    <span>- 45.87</span>
                                </div>
                            </div>
                            <canvas id="coin_sales1" height="100"></canvas>
                        </div>
                    </div>
                {% endfor %}
            </div>
            <div class="row">
                <div class="card">
                    <div class="card-body">
                        <div class="d-flex justify-content-between align-items-center">
                            <h4 class="header-title mb-0">Overview</h4>
                        </div>
                        <canvas id="verview-shart" width="600" height="200"></canvas>
                    </div>
                </div>
            </div>


            <!-- sales report area start -->
            <div class="sales-report-area mt-5 mb-5">
                <div class="row">
                    <canvas id="outputCanvas" width="600" height="200"></canvas>
                </div>
            </div>

            <div class="row" style="margin-top: 2%; margin-bottom: 2%;">

                <div class="col-md-6 mt-5">
                    <div class="card">
                        <h3>Booking bar chart (Order by Ascending)</h3>
                        <div class="card-body">
                            <canvas id="barChart1" width="400" height="400"></canvas>
                        </div>
                    </div>
                </div>


                <div class="col-md-6 mt-5">
                    <div class="card">
                        <h3>Booking bar chart (Order by Descending)</h3>
                        <div class="card-body">
                            <canvas id="barChart2" width="400" height="400"></canvas>
                        </div>
                    </div>
                </div>


            </div>


            <div class="row" style="margin-top:2%; margin-bottom: 2%">

                <div id="highpiechart4"></div>

            </div>
        </div>




    <div id="seomap">
        adfasdf
    </div>
        <!-- main content area end -->
        <!-- footer area start-->
        <footer>
            <div class="footer-area">
                <p></p>
            </div>
        </footer>
        <!-- footer area end-->
    </div>
    <!-- page container area end -->
    <!-- offset area start -->
    <div class="offset-area">
        <div class="offset-close"><i class="ti-close"></i></div>
        <ul class="nav offset-menu-tab">
            <li><a class="active" data-toggle="tab" href="#activity">Activity</a></li>
            <li><a data-toggle="tab" href="#settings">Settings</a></li>
        </ul>
        <div class="offset-content tab-content">
            <div id="activity" class="tab-pane fade in show active">
                <div class="recent-activity">

                </div>
            </div>
            <div id="settings" class="tab-pane fade">
                <div class="offset-settings">
                    <h4>General Settings</h4>
                    <div class="settings-list">
                        <div class="s-settings">
                            <div class="s-sw-title">
                                <h5>Notifications</h5>
                                <div class="s-swtich">
                                    <input type="checkbox" id="switch1"/>
                                    <label for="switch1">Toggle</label>
                                </div>
                            </div>
                            <p>Keep it 'On' When you want to get all the notification.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>










    <!-- offset area end -->
    <!-- jquery latest version -->
    <script src="{% static 'assets/js/vendor/jquery-2.2.4.min.js' %}"></script>
    <!-- bootstrap 4 js -->
    <script src="{% static 'assets/js/popper.min.js' %}"></script>
    <script src="{% static 'assets/js/bootstrap.min.js' %}"></script>
    <script src="{% static 'assets/js/owl.carousel.min.js' %}"></script>
    <script src="{% static 'assets/js/metisMenu.min.js' %}"></script>
    <script src="{% static 'assets/js/jquery.slimscroll.min.js' %}"></script>
    <script src="{% static 'assets/js/jquery.slicknav.min.js' %}"></script>

    <!-- start chart js -->
    <script src="{% static 'assets/js/charts.min.js' %}"></script>
    <!-- start highcharts js -->
    <script src="{% static 'assets/js/highcharts.js' %}"></script>
    <!-- start zingchart js -->
    <script src="{% static 'assets/js/zingchart.min.js' %}"></script>
    {#    <script>#}
    {#    zingchart.MODULESDIR = "https://cdn.zingchart.com/modules/";#}
    {#    ZC.LICENSE = ["569d52cefae586f634c54f86dc99e6a9", "ee6b7db5b51705a13dc2339db3edaf6d"];#}
    {#    </script>#}
    <!-- all line chart activation -->
    <script src="{% static 'assets/js/line-chart.js' %}"></script>
    <!-- all pie chart -->
    <script src="{% static 'assets/js/pie-chart.js' %}"></script>

    <!-- all bar chart activation -->
    <script src="{% static 'assets/js/bar-chart.js' %}"></script>
    <!-- others plugins -->
    <script src="{% static 'assets/js/plugins.js' %}"></script>
    <script src="{% static 'assets/js/scripts.js' %}"></script>
    <!-- start amchart js -->
    <script src="{% static 'assets/js/amcharts.js' %}"></script>
    <script src="{% static 'assets/js/ammap.js' %}"></script>


    <script src="{% static 'cht.js' %}"></script>




    <script src="{% static 'assets/js/vendor/jquery-2.2.4.min.js' %}"></script>
    <!-- bootstrap 4 js -->
    <script src="{% static 'assets/js/popper.min.js' %}"></script>
    <script src="{% static 'assets/js/bootstrap.min.js' %}"></script>
    <script src="{% static 'assets/js/owl.carousel.min.js' %}"></script>
    <script src="{% static 'assets/js/metisMenu.min.js' %}"></script>
    <script src="{% static 'assets/js/jquery.slimscroll.min.js' %}"></script>
    <script src="{% static 'assets/js/jquery.slicknav.min.js' %}"></script>
    <!-- start chart js -->
    <script src="{% static 'assets/js/charts.min.js' %}"></script>
    <!-- start highcharts js -->
    <script src="{% static 'assets/js/highcharts.js' %}"></script>
    <!-- start zingchart js -->
    <script src="{% static '/assets/js/zingchart.min.js' %}"></script>
    <script>
        zingchart.MODULESDIR = "https://cdn.zingchart.com/modules/";
        ZC.LICENSE = ["569d52cefae586f634c54f86dc99e6a9", "ee6b7db5b51705a13dc2339db3edaf6d"];
    </script>
    <!-- start amchart js -->
    <script src="{% static 'assets/js/amcharts.js' %}"></script>
    <script src="{% static 'assets/js/serial.js' %}"></script>
    <script src="{% static 'assets/js/export.min.js' %}"></script>
    <script src="{% static 'assets/js/light.js' %}"></script>
    <!-- all line chart activation -->
    <script src="{% static 'assets/js/line-chart.js' %}"></script>
    <!-- all bar chart activation -->
    <script src="{% static 'assets/js/bar-chart.js' %}"></script>
    <!-- all pie chart -->
    <script src="{% static 'assets/js/pie-chart.js' %}"></script>
    <!-- others plugins -->
    <script src="{% static 'assets/js/plugins.js' %}"></script>
    <script src="{% static 'assets/js/scripts.js' %}"></script>





















    <script src="{% static 'assets/js/worldLow.js' %}"></script>



    {% autoescape off %}
        <script type="text/javascript">

            new Chart(document.getElementById("verview-shart"), {
                type: 'line',
                data: {
                    labels: [

                        {#1500,1600,1700,1750,1800,1850,1900,1950,1999,2050#}
                        {% for row in growthtrend %}
                            {% if forloop.counter >= 11 and forloop.counter <= 21 %}
                                {{ row.year }},
                            {% endif %}
                        {% endfor %}

                    ],
                    datasets: [{
                        //Entire home/apt
                        data: [
                            {#86,114,106,106,107,111,133,221,783,2478#}
                            0,
                            {% for row in growthtrend %}
                                {% if forloop.counter >= 1 and forloop.counter <= 10 %}
                                    {{ row.counter }},
                                {% endif %}
                            {% endfor %}
                        ],
                        label: "Entire home/apt",
                        borderColor: "#3e95cd",
                        fill: false
                    }, {
                        //Private Room
                        data: [
                            {#282,350,411,502,635,809,947,1402,3700,5267#}
                            {% for row in growthtrend %}
                                {% if forloop.counter >= 11 and forloop.counter <= 21 %}
                                    {{ row.counter }},
                                {% endif %}
                            {% endfor %}

                        ],
                        label: "Private room",
                        borderColor: "#8e5ea2",
                        fill: false
                    }, {
                        data: [

                            {#168,170,178,190,203,276,408,547,675,734#}
                            0, 0, 0,
                            {% for row in growthtrend %}
                                {% if forloop.counter >= 22 %}
                                    {{ row.counter }},
                                {% endif %}
                            {% endfor %}


                        ],
                        label: "Shared room",
                        borderColor: "#3cba9f",
                        fill: false
                    }


                    ]
                },
                options: {
                    title: {
                        display: true,
                        text: 'Annual Growth Trend by Room Type'
                    }
                }
            });

            {#Scatter Plot#}

            var ctx = document.getElementById("outputCanvas").getContext('2d');

            /*var description = document.getElementById("description");
            description.innerText = response.data.description;*/
            var myChart = new Chart(ctx, {
                type: 'scatter',
                data: {
                    label: 'Scatter Dataset',
                    datasets: [{
                        data: [

                            {% for row in scatterboxplot %}
                                {
                                    x:{{ row.availability }}, y:{{ row.totalprice }}
                                },
                            {% endfor %}
                            ,

                        ],
                        label: 'Scattered Box Plot',
                        backgroundColor: 'rgba(255, 0, 0, 1)',
                    },
                    ]
                },
                options: {
                    title: {
                        display: true,
                        text: "35 Fastest times up Alpe d'Huez"
                    },
                    legend: {
                        display: true,
                    },

                    showLines: false,
                    scales: {
                        yAxes: [{
                            display: true,
                            scaleLabel: {
                                display: true,
                                labelString: 'Price',
                                fontSize: 16
                            },
                            ticks: {
                                beginAtZero: true,
                                fontSize: 14
                            }
                        }],
                        xAxes: [{
                            type: 'linear',
                            position: 'bottom',
                            display: true,
                            scaleLabel: {
                                display: true,
                                labelString: 'Availability',
                                fontSize: 16
                            },
                            gridLines: {
                                display: true
                            },
                            ticks: {
                                beginAtZero: false,
                                fontSize: 14,
                            }
                        }]
                    },
                    tooltips: {
                        displayColors: false,
                        callbacks: {
                            title: function (tooltipItems, data) {
                                var index = tooltipItems[0].index;
                                var datasetIndex = tooltipItems[0].datasetIndex;
                                var dataset = data.datasets[datasetIndex];
                                var datasetItem = dataset.data[index];

                                var person = response.data[datasetItem.id];
                                return person.Name + " - " + person.Nationality;
                            },
                            label: function (tooltipItems, data) {
                                var output = "";

                                var index = tooltipItems.index;
                                var datasetIndex = tooltipItems.datasetIndex;
                                var dataset = data.datasets[datasetIndex];
                                var datasetItem = dataset.data[index];

                                var person = response.data[datasetItem.id];

                                output += "TIme: " + person.Time + "\n | \n";
                                output += "Place: " + person.Place + "\n | \n";
                                output += "Year: " + person.Year + "\n | \n";
                                if (person.Doping === "") {
                                    output += "Doping: None";
                                } else {
                                    output += "Doping: " + person.Doping;
                                }
                                return output;
                            }
                        }
                    }
                }
            })

        </script>
    {% endautoescape %}


    <!-- Pie Chart !-->

    <script>

            /*-------------- 4 Pie chart highcharts start ------------*/
        if ($('#highpiechart4').length) {
            var pieColors = (function () {
                var colors = [],
                    base = Highcharts.getOptions().colors[0],
                    i;

                for (i = 0; i < 10; i += 1) {
                    // Start out with a darkened base color (negative brighten), and end
                    // up with a much brighter color
                    colors.push(Highcharts.Color(base).brighten((i - 3) / 7).get());
                }
                return colors;
            }());

            // Build the chart
            Highcharts.chart('highpiechart4', {
                chart: {
                    plotBackgroundColor: null,
                    plotBorderWidth: null,
                    plotShadow: false,
                    type: 'pie'
                },

                title: {
                    text: '<h3>Number of Listing by Room Type</h3>'
                },
                tooltip: {
                    pointFormat: '{series.name}: <b>{point.percentage:.1f}%</b>'
                },
                legend:
                    {
                        labels:
                            {
                                generateLabels: function (chart) {
                                    // Here
                                }
                            }
                    },

                plotOptions: {
                    pie: {
                        allowPointSelect: true,
                        cursor: 'pointer',
                        colors: pieColors,
                        dataLabels: {
                            style: {
                                "color": "contrast", "fontSize": "11px", "fontWeight": "bold", "textOutline": "",
                                "margin": "8px"
                            },
                            enabled: true,
                            format: '<b>{point.name}</b><br>{point.percentage:.1f} %',
                            distance: -80,
                            filter: {
                                property: 'percentage',
                                operator: '>',
                                value: 4
                            }
                        }
                    }
                },
                series: [{
                    name: 'Share',
                    data: [
                        {#{ name: 'USD', y: 61.41 },#}
                        {#{ name: 'BTC', y: 11.84 },#}
                        {#{ name: 'TCN', y: 10.85 },#}
                        {% for row in piechart %}
                            {name: '{{ row.roomtype }}', y: {{ row.percentg }}},
                        {% endfor %}

                    ]
                }]
            });
        }
        /*-------------- 4 Pie chart highcharts end ------------*/

    </script>

    <!-- Bar Chart 1 !-->
    <script>

        $(document).ready(function () {
            var horizontalBarChartData = {
                labels: [

                    {% for row in barchart_ascending %}
                        "{{ row.neighbourhood }}",
                    {% endfor %},
                ],
                datasets: [{
                    backgroundColor: "#00b0f0",
                    data: [{% for row in barchart_ascending %}

                        {{ row.total }},

                    {% endfor %}]
                }]

            };
            var ctx = document.getElementById("barChart1").getContext("2d");
            var myHorizontalBar = new Chart(ctx, {
                type: 'horizontalBar',
                data: horizontalBarChartData,
                options: {

                    scales: {
                        yAxes: [{
                            barThickness: 30,
                            ticks: {
                                beginAtZero: true,
                                mirror: false,
                            },
                        }],
                    },
                    responsive: true,
                    legend: {
                        display: false,
                        labels: {
                            fontSize: 0
                        }
                    },
                    title: {
                        display: true,
                        text: 'Bar Chart'
                    },
                    animation: {
                        duration: 1,
                        onComplete() {
                            const chartInstance = this.chart;
                            const ctx = chartInstance.ctx;
                            const dataset = this.data.datasets[0];
                            const meta = chartInstance.controller.getDatasetMeta(0);

                            {#Chart.helpers.each(meta.data.forEach((bar, index) => {#}
                            {#    const label = this.data.labels[index];#}
                            {#    const labelPositionX = 100;#}
                            {#    const labelWidth = ctx.measureText(label).width + labelPositionX;#}
                            {##}
                            {#    ctx.textBaseline = 'middle';#}
                            {#    ctx.textAlign = 'left';#}
                            {#    ctx.fillStyle = '#333';#}
                            {#    ctx.fillText(label, labelPositionX, bar._model.y);#}
                        }
                    }
                }
            });
        });

    </script>

    <!-- Bar Chart 2 !-->
    <script>

        $(document).ready(function () {
            var horizontalBarChartData = {
                labels: [
                    {% for row in barchart_descending %}
                        "{{ row.neighbourhood }}",
                    {% endfor %},
                ],
                datasets: [{
                    backgroundColor: "#00b0f0",
                    data: [{% for row in barchart_descending %}
                        {{ row.total }},
                    {% endfor %}]
                }]

            };
            var ctx = document.getElementById("barChart2").getContext("2d");
            var myHorizontalBar = new Chart(ctx, {
                type: 'horizontalBar',
                data: horizontalBarChartData,
                options: {
                    scales: {
                        yAxes: [{
                            barThickness: 30,
                            ticks: {
                                beginAtZero: true,
                                mirror: false,
                            },
                        }],
                    },
                    responsive: true,
                    legend: {
                        display: false,
                    },
                    title: {
                        display: true,
                        text: 'Bar Chart'
                    },
                    animation: {
                        duration: 1,
                        onComplete() {
                            const chartInstance = this.chart;
                            const ctx = chartInstance.ctx;
                            const dataset = this.data.datasets[0];
                            const meta = chartInstance.controller.getDatasetMeta(0);

                            {#Chart.helpers.each(meta.data.forEach((bar, index) => {#}
                            {#    const label = this.data.labels[index];#}
                            {#    const labelPositionX = 60;#}
                            {#    const labelWidth = ctx.measureText(label).width + labelPositionX;#}
                            {##}
                            {#    ctx.textBaseline = 'middle';#}
                            {#    ctx.textAlign = 'left';#}
                            {#    ctx.fillStyle = '0';#}
                            {#    ctx.fillText(label, labelPositionX, bar._model.y);#}

                        }
                    }
                }
            });
        });

    </script>


    {% autoescape off %}
<script type="text/javascript">

/* ------------- map amchart 7 start ------------ */
var map = AmCharts.makeChart("seomap", {
    "type": "map",
    "theme": "light",
    "projection": "miller",

    "imagesSettings": {
        "rollOverColor": "#089282",
        "rollOverScale": 3,
        "selectedScale": 3,
        "selectedColor": "#089282",
        "color": "#13564e"
    },

    "areasSettings": {
        "unlistedAreasColor": "#15A892"
    },

    "dataProvider": {
        "map": "worldLow",
        "images": [
            {% for object in listofobjects %}
            {
            "zoomLevel": 5,
            "scale": 0.5,
            "title": "{{ object.neighbourhood }}",
            "latitude": {{ object.latitude }},
            "longitude": {{ object.longitude }}
        },{% endfor %}]
    }
});

map.addListener("positionChanged", updateCustomMarkers);
function updateCustomMarkers(event) {
    // get map object
    var map = event.chart;

    // go through all of the images
    for (var x in map.dataProvider.images) {
        // get MapImage object
        var image = map.dataProvider.images[x];

        // check if it has corresponding HTML element
        if ('undefined' == typeof image.externalElement)
            image.externalElement = createCustomMarker(image);

        // reposition the element accoridng to coordinates
        var xy = map.coordinatesToStageXY(image.longitude, image.latitude);
        image.externalElement.style.top = xy.y + 'px';
        image.externalElement.style.left = xy.x + 'px';
    }
}


function createCustomMarker(image) {
    // create holder
    var holder = document.createElement('div');
    holder.className = 'map-marker';
    holder.title = image.title;
    holder.style.position = 'absolute';

    // maybe add a link to it?
    if (undefined != image.url) {
        holder.onclick = function() {
            window.location.href = image.url;
        };
        holder.className += ' map-clickable';
    }

    // create dot
    var dot = document.createElement('div');
    dot.className = 'dot';
    holder.appendChild(dot);

    // create pulse
    var pulse = document.createElement('div');
    pulse.className = 'pulse';
    holder.appendChild(pulse);

    // append the marker to the map container
    image.chart.chartDiv.appendChild(holder);



    return holder;
}
/* ------------- map amchart 7 END ------------ */

</script>
{% endautoescape %}



{% endblock %}